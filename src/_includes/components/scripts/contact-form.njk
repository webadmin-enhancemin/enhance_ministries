// Show/hide message field based on interest selection
const interestSelect = document.getElementById('interest');
const messageGroup = document.getElementById('message-group');
const messageTextarea = document.getElementById('message');

if (interestSelect) {
    interestSelect.addEventListener('change', function() {
        if (this.value === 'Other (specify below)') {
            messageGroup.style.display = 'block';
            messageTextarea.required = true;
        } else {
            messageGroup.style.display = 'none';
            messageTextarea.required = false;
            messageTextarea.value = '';
        }
    });
}

// Contact form submission via Web3Forms
const contactForm = document.getElementById('contact-form');
const formStatus = document.getElementById('form-status');
const submitBtn = document.getElementById('submit-btn');

if (contactForm) {
    contactForm.addEventListener('submit', async function(e) {
        e.preventDefault();

        const originalText = submitBtn.textContent;
        submitBtn.textContent = 'Sending...';
        submitBtn.disabled = true;
        formStatus.className = 'form-status';
        formStatus.textContent = '';

        try {
            const formData = new FormData(contactForm);
            const response = await fetch('https://api.web3forms.com/submit', {
                method: 'POST',
                body: formData
            });
            const data = await response.json();

            if (data.success) {
                formStatus.className = 'form-status success';
                formStatus.textContent = 'Message sent! Matt will follow up with you soon.';
                contactForm.reset();
                messageGroup.style.display = 'none';
                messageTextarea.required = false;
            } else {
                formStatus.className = 'form-status error';
                formStatus.textContent = 'Something went wrong. Please try again or email matt@enhancemin.com directly.';
            }
        } catch (error) {
            formStatus.className = 'form-status error';
            formStatus.textContent = 'Unable to send message. Please check your connection or email matt@enhancemin.com directly.';
        } finally {
            submitBtn.textContent = originalText;
            submitBtn.disabled = false;
        }
    });
}
